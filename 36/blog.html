<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>In the Defense of Spaghetti Code - 250bpm</title>
    
    	<script type="text/javascript" src="http://www.wikidot.com/default__flow/login__CustomDomainScript?site_id=148706"></script>

    
    <script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--javascript/init.combined.js"></script>
    <script  type="text/javascript">
        var URL_HOST = 'www.wikidot.com';
        var URL_DOMAIN = 'wikidot.com';
        var USE_SSL =  true ;
        var URL_STATIC = 'http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9';
        // global request information
        
        var WIKIREQUEST = {};
        WIKIREQUEST.info = {};
        
        WIKIREQUEST.info.domain = "250bpm.com";
        WIKIREQUEST.info.siteId = 148706;
        WIKIREQUEST.info.siteUnixName = "250bpm";
        WIKIREQUEST.info.categoryId = 2550760;
        WIKIREQUEST.info.themeId = 18520;
        WIKIREQUEST.info.requestPageName = "blog:36";
        OZONE.request.timestamp = 1594263535;
        OZONE.request.date = new Date();
        WIKIREQUEST.info.lang = 'en';
                WIKIREQUEST.info.pageUnixName = "blog:36";
        WIKIREQUEST.info.pageId = 21825325;
                        WIKIREQUEST.info.lang = "en";
        OZONE.lang = "en";
        var isUAMobile = !!/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    </script>
    
    


    
        <script  type="text/javascript">
    
        require.config({
            baseUrl: URL_STATIC + '/common--javascript',
            paths: {
                'jquery.ui': 'jquery-ui.min',
                'jquery.form': 'jquery.form'
            }
        });
    
    </script>
    
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
            
    
    
    
    
    <meta http-equiv="content-language" content="en"/>
    <script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--javascript/WIKIDOT.combined.js"></script>
        
    
    <style type="text/css" id="internal-style">
        
        /* modules */
        
                
        /* theme */
                    @import url(http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--theme/base/css/style.css);
                    @import url(http://250bpm.wdfiles.com/local--theme/250bpm/style.css);
            </style>
    
        
        
        
    <link rel="shortcut icon" href="/local--favicon/favicon.gif"/>
    <link rel="icon" type="image/gif" href="/local--favicon/favicon.gif"/>
    
            <link rel="apple-touch-icon" href="/common--images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="/common--images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="/common--images/apple-touch-icon-114x114.png" />
        
        
            <link rel="alternate" type="application/wiki" title="Edit this page" href="javascript:WIKIDOT.page.listeners.editClick()"/>
    
        <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-18234656-1']);
        _gaq.push(['_setDomainName', 'none']);
        _gaq.push(['_setAllowLinker', true]);
        _gaq.push(['_trackPageview']);

        _gaq.push(['old._setAccount', 'UA-68540-5']);
        _gaq.push(['old._setDomainName', 'none']);
        _gaq.push(['old._setAllowLinker', true]);
        _gaq.push(['old._trackPageview']);

                _gaq.push(['userTracker._setAccount', 'UA-3207370-9']);
        _gaq.push(['userTracker._trackPageview']);
            </script>
    
    <script type="text/javascript">
        window.google_analytics_uacct = 'UA-18234656-1';
        window.google_analytics_domain_name = 'none';
    </script>
    
        <link rel="manifest" href="/onesignal/manifest.json" />
    <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" acync=""></script>
    <script>
        var OneSignal = window.OneSignal || [];
        OneSignal.push(function() {
          OneSignal.init({
            appId: null,
          });
        });
    </script>
        
<link rel="alternate" type="application/rss+xml" title="Comments for the page &quot;In the Defense of Spaghetti Code&quot;" href="/feed/page/comments-21825325.xml"/><script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/ForumCommentsModule.js"></script>
<script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/ForumViewThreadModule.js"></script>
<script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/ForumViewThreadPostsModule.js"></script>
<script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/sub/ForumNewPostFormModule.js"></script>
</head>
<body id="html-body">
<div id="skrollr-body">
<a name="page-top"></a>





<div id="container-wrap-wrap">
    <div id="container-wrap">
        <div id="container">
            <div id="header">
              <h1><a href="/"><span>250bpm</span></a></h1>
                
                
                <!-- google_ad_section_start(weight=ignore) -->
                
                <div id="search-top-box" class="form-search">
    <form id="search-top-box-form" action="dummy" class="input-append">
        <input id="search-top-box-input" class="text empty search-query" type="text" size="15" name="query" value="Search this site" onfocus="if(YAHOO.util.Dom.hasClass(this, 'empty')){YAHOO.util.Dom.removeClass(this,'empty'); this.value='';}"/><input class="button btn" type="submit" name="search" value="Search"/>
    </form>
</div>
                
                
                    <div id="top-bar">
                        

<ul>
<li><a href="/">Home</a></li>
<li><a href="https://github.com/sustrik/cartesian">Cartesian</a></li>
<li><a href="http://libdill.org">Libdill</a></li>
<li><a href="http://nanomsg.org">Nanomsg</a></li>
<li><a href="https://github.com/sustrik/tiles">Tiles</a></li>
<li><a href="http://zero.mq">ZeroMQ</a></li>
<li><a href="/contact">Contact</a></li>
</ul>

                    </div>
                
                <div id="login-status"><a href="javascript:;" onclick="WIKIDOT.page.listeners.createAccount(event)" class="login-status-create-account btn">Create account</a> <span>or</span> <a href="javascript:;" onclick="WIKIDOT.page.listeners.loginClick(event)" class="login-status-sign-in btn btn-primary">Sign in</a> </div>
                <div id="header-extra-div-1"><span></span></div><div id="header-extra-div-2"><span></span></div><div id="header-extra-div-3"><span></span></div>
            </div>
            
            <div id="content-wrap">
                
                    <div id="side-bar">
                        


                        


                        


                    </div>
                
                
                <!-- google_ad_section_end -->
                
                <div id="main-content">
                    <div id="action-area-top"></div>
                    
                    
                        <div id="page-title">
                            In the Defense of Spaghetti Code
                        </div>
                    

                    

                    



                    <div id="page-content">
                        

<div style="width:50em"><div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Previous:</strong> <a href="/blog:35">Poor Man's Scientific Method</a></p>
</div>
    
    
    
    </div><div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Next:</strong> <a href="/blog:37">Code Generation &amp; Visual Smog in Code (part I)</a></p>
</div>
    
    
    
    </div>
<p>Have you ever seen a function that spans 1500 lines of code?</p>
<p>At that point every semi-decent programmer curses spaghetti code in general and the author of the function in particular and embarks on the task of breaking it into managable chunks, trying to decompose the problem into orthogonal issues, layer the design properly, move the common functionality into base classes, create convenient and sufficiently generic extension points et c.</p>
<p>If done properly, they'll end up with well-defined components, short functions that do one thing only, and generally, with a nicer and more maintainable code.</p>
<p>Everybody is happy and everybody pats the semi-decent programmer on the back.</p>
<p>&#8230;</p>
<p>It turns out that the 1500-line function was parsing a network protocol. It is a 30-year old, complex and convoluted Behemoth of a protocol, defined by many parties fighting over the specification, full of compromises and special cases, dragged through multiple standardisation bodies and then anyway slightly customised by each vendor.</p>
<p>At some point, the product is sold to a different customer who happens to need integration with a software from a different vendor, Foosoft Inc. As already said, there are minor differences in the protocol among the vendors. The parser has to be slightly altered.</p>
<p>Unfortunately, it turns out that the tweak intersects the boundary between two well-defined components in the implementation. The right thing to do would be to re-think the architecture of the parser and to re-factor the codebase accordingly.</p>
<p>However, the discrepancy in the protocol is really a minor one and has to accounted for by tomorrow. No way the programmer is going to sell the idea of re-factoring the whole parser to the management. Thus, he goes for the minimal change and modifies the following function:</p>
<div class="code">
<pre>
<code>int new_sequence_number (int old_sqn)
{
    return old_sqn + 1;
}</code>
</pre></div>
<p>in the following way:</p>
<div class="code">
<pre>
<code>int new_sequence_number (int old_sqn, int foosoft)
{
    if (foosoft)
        return old_sqn + 2;
    else
        return old_sqn + 1;
}</code>
</pre></div>
<p>Later on it turns out that the problem of non-consistent sequence numbering was recognised by yet another standards body (Bar Consortium) which released version 5.34.2 of the protocol that actually unifies the algorithm of generating the sequence numbers. Now we have to support version 5.34.2 as well:</p>
<div class="code">
<pre>
<code>int new_sequence_number (int old_sqn, int foosoft)
{
    if (foosoft == 2) // version 5.34.2 of the protocol
        return old_sqn + 3;
    else if (foosoft)
        return old_sqn + 2;
    else
        return old_sqn + 1;
}</code>
</pre></div>
<p>At this point you should be able to see where I am heading: After few such iterations the code that was originally nice and manageable becomes a mess of short functions plagued by lots of behavior-modifying arguments, the clean boundaries between components and layers are slowly dissolved and nobody is sure anymore what effect any particular change may have.</p>
<p>Let's imagine we want to make the above function nicer:</p>
<div class="code">
<pre>
<code>int new_sequence_number (int old_sqn, int step)
{
    return old_sqn + 1 + step;
}</code>
</pre></div>
<p>It looks all right but then it turns out that foosoft=4 is already being used to identify yet another vendor who uses sequence numbering step of 2. The beautification have actually broken the product! The patch is hastily reverted.</p>
<p>At this point everybody wishes they had only a single 1500-line long parsing function that would be much easier to understand, debug and modify than this mess of dozens of interconnected abominations. It's too late though to do that. Nobody dares anymore.</p>
<p>&#8230;</p>
<p>The point I am trying to make in this article is that sometimes it's the problem domain itself that's complex and convoluted. In short, it's a spaghetti domain.</p>
<p>Human-crafted and gradually evolved domains are often like this. Think of law. There are more exceptions than there are laws. Think of all kinds of standards. Regulatory directives. Products offered by a big bank. Different tastes os ARM microarchitecture.</p>
<p>In such cases you should seriously consider whether not even trying to break up the problem into fine-grained orthogonal chunks isn't the right thing to do. You may end up with long functions that will be frowned upon as spaghetti code by everyone who ever looks at the code, but you will sleep peacefully, knowing what kind of manageability nightmare you have avoided.</p>
<p>PS. If you happen to be a developer of a static analysis tool: Consider leaving long functions alone, rather then reporting them as suspicious. There are circumstances where long functions are perfectly legal and desirable.</p>
<p>EDIT: Long functions with gotos are as bad a mess of little functions. Luckily though, 45 years after Dijkstra's paper, goto is not used extensively any more.</p>
<p>EDIT: The discussion about this article on Reddit gave me an idea of good example of a spaghetti domain: Imagine you are modelling buildings in software. First you model <a href="https://encrypted.google.com/search?tbm=isch&amp;q=empire%20states%20building&amp;tbs=imgo:1">Empire States Building</a>. It's rectangular, it has 103 stories, most of them almost identical. Individual features are repeated over and over. etc. It's a nice example of orderly domain. It can be described in few simple functions. Then you try to model <a href="https://encrypted.google.com/search?tbm=isch&amp;q=kowloon%20walled%20city&amp;tbs=imgo:1">Kowloon Walled City</a>. Any possible generic rule you try to make about it was violated by some poor chinese emmigrant trying to survive in the compound. No feature is repeated. Ever. In such case it's better to draw a map (as the japanese speleological team that explored the building did) and put every little detail in there.</p>
<p><strong>Martin Sústrik, March 25th, 2013</strong></p>
<div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Previous:</strong> <a href="/blog:35">Poor Man's Scientific Method</a></p>
</div>
    
    
    
    </div><div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Next:</strong> <a href="/blog:37">Code Generation &amp; Visual Smog in Code (part I)</a></p>
</div>
    
    
    
    </div>
<div style="height:2em"></div>
<div class="comments-box">
		
	<div class="options" id="comments-options-hidden" style="display: none">
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumCommentsModule.listeners.showComments(event)">Show Comments</a> 
	</div>
		
	<div id="thread-container" class="thread-container" style="margin-top: 1em">
					


<script type="text/javascript">
	WIKIDOT.forumThreadId = 831104;
</script>


	<div class="options" id="comments-options-shown">
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumCommentsModule.listeners.hideComments(event)" class="btn btn-default btn-small btn-sm">Hide All Comments</a> 
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.unfoldAll(event)" class="btn btn-default btn-small btn-sm">Unfold All</a> 
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.foldAll(event)" class="btn btn-default btn-small btn-sm">Fold All</a>
	</div>

<div id="thread-container-posts" style="display: none">
    

<div class="pager"><span class="pager-no">page 1 of 2</span><span class="current">1</span><span class="target"><a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadPostsModule.listeners.updateList(2)">2</a></span><span class="target"><a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadPostsModule.listeners.updateList(2)">next &raquo;</a></span></div>

	
					
      
    <div class="post-container" id="fpc-1998287">
                      
		<div class="post" id="post-1998287">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998287)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998287">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=bb5a187be94fd27efcc320261da67383&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>lmm (guest)</span> <span class="odate time_1395749831 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:17</span>
														</div>
			</div>
			<div class="content" id="post-content-1998287">
									

<p>I've never found any web of interconnected components so bad that I'd prefer to have a 1500-line function.</p>
<p>Sure, rushed bugfixes make code worse. But there's nothing magic about 1500-line functions that means a rushed bugfix is not going to make it worse. You're just less likely to notice because by the time you've allowed a 1500-line function you've given up trying to sanely maintain the system.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998287)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998287)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998287" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998287)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998287)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=bb5a187be94fd27efcc320261da67383&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>lmm (guest)</span>, <span class="odate time_1395749831 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:17</span>
		</div>
	</div>
 
                
                	


        
                      
    <div class="post-container" id="fpc-1998289">
                      
		<div class="post" id="post-1998289">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998289)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998289">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1395749989 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:19</span>
														</div>
			</div>
			<div class="content" id="post-content-1998289">
									

<p>That's the whole point. You can give up immediately. There's no way to sanely maintain something that is insane in the first place. The body of law is a pretty good example of the phenomenon. It's too complex and convoluted to model it in a nice and sane way.</p>

							</div>

								
							<div class="changes">
					Last edited on <span class="odate time_1395751084 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:38</span>
					by <span class="printuser"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>
					<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.showHistory(event,1998289)"><i class="icon-plus"></i> Show more</a>
				</div>
				<div class="revisions" style="display: none"></div>
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998289)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998289)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998289" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998289)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998289)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1395749989 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:19</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 

	
					
      
    <div class="post-container" id="fpc-1998302">
                      
		<div class="post" id="post-1998302">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998302)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998302">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=33ba1c6213a1c4eb2ca6181a29fee8e4&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>William Payne (guest)</span> <span class="odate time_1395751217 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:40</span>
														</div>
			</div>
			<div class="content" id="post-content-1998302">
									

<p>This sort of reminds me of Rodney Brook's commentary on essential and accidental complexity. Once you have got rid of the accidental complexity, you are left with the essential complexity, which cannot be further reduced without compromising on functionality.</p>
<p>You can shovel the essential complexity around your system design all you like, but the overall quantity of complexity still remains constant. A practical consequence of this is that you can move the complexity away from the 1500 line function by splitting it up into smaller functions, but that complexity remains embedded in the implicit relationship that exists between all of your 50 line functions. (Plus some additional overhead from the function declarations themselves).</p>
<p>Of course, splitting up the large function into smaller ones gives you other benefits: Primarily the ability to test each small function in isolation, but also (and more importantly) the ability to read and understand the scope and purpose of each small function without being confused by irrelevant details.</p>
<p>Personally, I would like to have the ability to give names to chunks of code within a large function - and to write tests for those chunks without having to extract them into separate smaller functions.</p>
<p>I would also like to see better tools (and widespread usage of those that exist) for building various graphs and diagrams showing the call-graph and other relationships between functions and objects, so that we can explore, understand, and communicate the implicit complexity encoded in program structure more easily.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998302)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998302)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998302" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998302)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998302)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=33ba1c6213a1c4eb2ca6181a29fee8e4&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>William Payne (guest)</span>, <span class="odate time_1395751217 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:40</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-1998314">
                      
		<div class="post" id="post-1998314">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998314)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998314">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1395752264 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:57</span>
														</div>
			</div>
			<div class="content" id="post-content-1998314">
									

<p>Generally, agreed, but:</p>
<blockquote>
<p>the ability to read and understand the scope and purpose of each small function without being confused by irrelevant details</p>
</blockquote>
<p>In the examples above I've tried to explain why expecting each function to nice and neat semantics is naive. As the system evolves the existing decomposition into functions is going to gradually break (because the domain itself is spaghetti). You'll end up with functions with 25 boolean arguments, each saying 'do this little thing a little bit differently'.</p>
<p>Even worse, the concept of what is each function designed to do will slowly dissolve because of the said changes. At that point the conceptual model of the application remains only in your head. Once you leave the company and the code is assigned to a different developer, he's not going to understand what are the functions supposed to do and wish you have just written a single 1500-line function that's at least kind of linear and easy to follow.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998314)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998314)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998314" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998314)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998314)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1395752264 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 12:57</span>
		</div>
	</div>
 
                
        
            </div>
 
                      
    <div class="post-container" id="fpc-2002312">
                      
		<div class="post" id="post-2002312">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2002312)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2002312">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=68908bbee9395a201c35f1ddc919fdac&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Phil_haynes (guest)</span> <span class="odate time_1396274633 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">31 Mar 2014 14:03</span>
														</div>
			</div>
			<div class="content" id="post-content-2002312">
									

<p>Sorry for the pedantry - wasn't it Fred Brooks who wrote the Mythical Man Month and Rodney Brooks is into robots?</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2002312)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2002312)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2002312" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2002312)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2002312)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=68908bbee9395a201c35f1ddc919fdac&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Phil_haynes (guest)</span>, <span class="odate time_1396274633 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">31 Mar 2014 14:03</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 

	
					
      
    <div class="post-container" id="fpc-1998331">
                      
		<div class="post" id="post-1998331">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998331)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998331">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=99effa06dc825590a8223afa81de3ee5&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Murray Todd Williams (guest)</span> <span class="odate time_1395754224 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 13:30</span>
														</div>
			</div>
			<div class="content" id="post-content-1998331">
									

<p>Good point. I often look at problems through the &quot;SOA architecture&quot; lens where it is encouraged to think of all the &quot;loose coupling&quot; and &quot;tight coupling&quot; between things and to try to concentrate as much of the necessary &quot;tight coupling&quot; in a few choice places so that everything else has very loose coupling and is thus more flexible and composable.</p>
<p>In other words, in a situation like this, much of &quot;the spaghetti domain&quot; probably gets concentrated in this hypothetical 1500 line function so that most of the other functions will end up being a lot cleaner. To break up the 1500 line function into a whole bunch of components will create a crazy functional/inheritance diagram between dozens of classes that don't really have to do with the problem domain.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998331)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998331)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998331" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998331)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998331)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=99effa06dc825590a8223afa81de3ee5&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Murray Todd Williams (guest)</span>, <span class="odate time_1395754224 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 13:30</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-1998336">
                      
		<div class="post" id="post-1998336">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998336)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998336">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1395755294 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 13:48</span>
														</div>
			</div>
			<div class="content" id="post-content-1998336">
									

<p>Yes. Great way of putting it!</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998336)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998336)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998336" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998336)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998336)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1395755294 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 13:48</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 

	
					
      
    <div class="post-container" id="fpc-1998357">
                      
		<div class="post" id="post-1998357">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998357)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998357">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=5540796cef3803aa6a9a2bcb62983858&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>kikito (guest)</span> <span class="odate time_1395757637 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 14:27</span>
														</div>
			</div>
			<div class="content" id="post-content-1998357">
									

<blockquote>
<p>It looks all right but then it turns out that foosoft=4 is already<br />
being used to identify yet another vendor who uses sequence<br />
numbering step of 2. The beautification have actually broken the product!<br />
The patch is hastily reverted.</p>
</blockquote>
<p>There are several things that I consider wrong on this approach.</p>
<p>First, the text doesn't mention it explicitly, but it seems that the issue was detected when the new code was already in production. It should have been picked up in a staging environment, not in a production environment.</p>
<p>Second, when you encounter a huge-ass function, the first thing you have to do is look for tests. If there are no tests, the first thing you must do is write the tests - from whatever documentation / knowledge there is. *Then* you can start refactoring.</p>
<p>If the code had been passed around several times and it had no tests and no docs, chances are that you will get bitten by &quot;implicitness&quot; like the foosoft=4 case.</p>
<p>But the responsible way of doing things not &quot;reverting the patch and leaving it like that&quot;. You add another test for the one-off case (foosoft=4), then redo the &quot;beautification&quot; (more on that later) and then you push those changes to the staging server for testing. And after they are verified, you can move them to production (even then, you can add them gradually, with feature flags). And if new &quot;implicit cases&quot; arise, you add tests and refactor until everything is discovered and nothing remains implicit.</p>
<p>Finally, the article seems to infer that refactoring is &quot;about the looks&quot;. It mentions &quot;code looking nice&quot; and &quot;beautification&quot;. The point of refactoring is not beauty; it's utility. Code is refactored so that it is *better at communicates what it does to humans*.</p>
<p>A proper refactoring of the function would have taken this into account.</p>
<div class="code">
<pre>
<code>int new_sequence_number(int old_sqn, int foosoft) {
  if(is_vendor_a(foosoft)) {
    return vendor_a_new_sequence_number(old_sqn, foosoft);
  } else if(is_ventor_b(foosoft)) {
    return vendor_b_new_sequence_number(old_sqn, foosoft);
  } else {
    return old_sqn + 1;
  }
}</code>
</pre></div>
<br />
The important thing this function does is *not* calculating the new sequence; it's deciding whether what kind of sequence we're calculating. The particularities of how to calculate it are left to other functions. By using explicit names we make the code more *clear* (not necessarily more beautiful or elegant). There's no &quot;implicitness&quot; here.
<p>If you &quot;leave the big functions untouched&quot; you are part of the problem, and a not particularly good programmer. Sure, if an impending deadline forces you to, take shortcuts, but reserve some time later on to &quot;pay the debt&quot; you incurred into.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998357)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998357)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998357" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998357)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998357)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=5540796cef3803aa6a9a2bcb62983858&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>kikito (guest)</span>, <span class="odate time_1395757637 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 14:27</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-1998383">
                      
		<div class="post" id="post-1998383">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998383)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998383">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1395760132 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 15:08</span>
														</div>
			</div>
			<div class="content" id="post-content-1998383">
									

<p>OK, here's the story:</p>
<p>You've inherited the code in question. The particular case foosoft=4 was written 20 years ago by a guy who died in the meantime.</p>
<p>You find the problem and you see the code is in terrible shape and you are able to convince your management to spend say 1 manyear on decyphering the code and writing the tests. Then you convince them to allocate one more manyear to refactor the code in a clean way.</p>
<p>Once done a deployed, you get a new change request from the customer. But alas! It cuts straight through your well-defined functions and components! (Remember that this is inevitable: The domain itself is spaghetti such as regulatory directives or telco protocols.)</p>
<p>At this point you'll try to convince your manager to allocate more time on refactoring. The answer would be: &quot;You've got 2 manyears to do refactoring. You've finished two weeks ago. And now you asking me for more time to refactor? Shut up and do your work.&quot;</p>
<p>And he is right. Refactoring every two weeks is not a realistic option. In such environment, simply keeping the code in a single function is the best bet: It's at least linear and relatively easy to understand and modify.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998383)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998383)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998383" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998383)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998383)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1395760132 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 15:08</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-1998725">
                      
		<div class="post" id="post-1998725">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998725)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998725">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=5540796cef3803aa6a9a2bcb62983858&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>kikito (guest)</span> <span class="odate time_1395791471 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 23:51</span>
														</div>
			</div>
			<div class="content" id="post-content-1998725">
									

<p>You are using strawman arguments here.</p>
<p>First you talked about a 1500-line function. Then you say that you need a 1 manyear to decypher and write the tests. That does not match.</p>
<p>If it's a huge library with lots of functions, you don't need to do everything in 1 go. You can refactor as you go: when you need to &quot;touch&quot; one function, write the tests for that individual function, and then refactor.</p>
<blockquote>
<p>But alas! It cuts straight through your well-defined functions and components! (Remember that this is inevitable: The domain itself is spaghetti such as regulatory directives or telco protocols.)</p>
</blockquote>
<p>Saying &quot;the domain is spaghetti&quot; does not mean anything. All domains change. All domains that are worth writing programs about are complex.</p>
<p>Code can't be done like a building, or a bridge. Bridges have the Laws of Physics. Code lives in a changing environment. You can't build a bridge if every moment gravity changes, and the next one steel becomes jelly.</p>
<p>That's why they pay us: to make code that not only works, but adapts to changes. That is the whole point. You must know how to make code that adapts. If you don't, search for help - read, go to workshops, or do something. It is your job to know how to do those things.</p>
<p>The code you showed is not a product of &quot;the domain&quot;. It's a consequence of bad programming practices, and nothing else (with the possible exception of badly informed management).</p>
<blockquote>
<p>And he is right. Refactoring every two weeks is not a realistic option.</p>
</blockquote>
<p>Another strawman argument. I never said refactoring every two weeks. I say refactor *as much as you can*; not every 2 weeks, every day.</p>
<p>And explain the problems of not refactoring to your manager, which is also part of your job.</p>
<p>Your manager's immediate job is to increase the ROI, but in a larger scale he also should make informed tactical decisions. Your job is to provide him with all the information to make those decisions.</p>
<p>Let me present you both scenarios.</p>
<p>If you add tests and refactor, at the beginning (and for some time, depending on the size of the library) you will go more slowly. But sooner or later adding features will become easier, you will get less bugs. And you will be happier. If you end up leaving the project, a new programmer picking it up will have lots of help from the tests.</p>
<p>If you just leave the big functions be, you will eventually get tired of maintaining that monstrosity. And then you will start looking for other jobs. And then you will leave your company, and your manager will be left with a new programmer, who won't have any idea of what the code does or why. The cycle will repeat.</p>
<p>Adding new features will get increasingly more difficult, and bugs will appear with increasing frequency. At the end either the company will lose their clients or they will have to abandon the product and start from scratch.</p>
<p>Choose.</p>

							</div>

								
					
						<div class="options">
				
																					<a href="javascript:;" onclick="togglePostOptions(event,1998725)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998725" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998725)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998725)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=5540796cef3803aa6a9a2bcb62983858&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>kikito (guest)</span>, <span class="odate time_1395791471 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">25 Mar 2014 23:51</span>
		</div>
	</div>
 
                
        
            </div>
 
                      
    <div class="post-container" id="fpc-1998764">
                      
		<div class="post" id="post-1998764">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998764)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998764">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1395796126 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 01:08</span>
														</div>
			</div>
			<div class="content" id="post-content-1998764">
									

<p>It looks like you have never worked in a spaghetti domain.</p>
<p>If you are really interested, look for example at telco protocols at 3gpp.org You'll find thousands of pages of completely incoherent stuff.</p>
<p>If you value your time you should rather skip that and think about a similar system that we are all familiar with: the legal code. Once again, thousands of pages of incoherent and sometimes even contradictory rules. Then yet more pages to paper over the inconsistencies. Et c.</p>
<p>The problem with modeling such domain is that no rule really holds. Any assertion you'll make will have exceptions.</p>
<p>Now, without universally valid rules, there's no way to decompose the problem into smaller, manageable chunks. Any boundary you draw between components will be violated by some peculiarity from the domain.</p>
<p>From my own experience, what happens in reality is that people start modelling a little subdomain of the whole spaghetti domain and they find some generic rules that hold. They decompose the application according to those rules, only to find out that all their assumptions are violated when the scope of the project extends a bit out of the little subdomain. They may refactor at that point. But then the scope widens again and again and nobody really wants to do any more refactoring, so it all ends as a tangle of incomprehensible functions.</p>
<p>What I am trying to say is that you sometimes have to acknowledge that the domain you are modelling is a mess and will remain to be a mess. In such environment it's better not to try to be smart and go for the simplest possible modelling paradigm (e.g. a long function with a lot of 'if' and 'switch' statements).</p>

							</div>

								
							<div class="changes">
					Last edited on <span class="odate time_1395796167 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 01:09</span>
					by <span class="printuser"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>
					<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.showHistory(event,1998764)"><i class="icon-plus"></i> Show more</a>
				</div>
				<div class="revisions" style="display: none"></div>
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998764)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998764)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998764" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998764)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998764)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1395796126 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 01:08</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 
            </div>
 

	
					
      
    <div class="post-container" id="fpc-1998793">
                      
		<div class="post" id="post-1998793">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998793)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998793">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=7196533b5aa2fc52c21517218723b2c4&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Garrett D'Amore (guest)</span> <span class="odate time_1395798938 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 01:55</span>
														</div>
			</div>
			<div class="content" id="post-content-1998793">
									

<p>This problem is very common in device drivers. Vendors clone each others chips, and each rev of silicon introduces new warts, features, and outright bugs.</p>
<p>The tulip.c linux driver used to be a case in point &#8212; it was several times as large as it would be if it just supported one variant of device &#8212; it was more special cases than actual code flow. (I've not looked at that code in over a decade.)</p>
<p>When I wrote drivers for similar chips for Solaris, I quite consciously decided that I would *not* try to cover all the variants in a single driver.</p>
<p>Sometimes, its easier to just copy the source to a new driver to support the new chip (or network protocol!), and edit for the new without worrying about preserving compatibility with the old. Its also *safer*, since you've not broken anything that *was* working, and your new test matrix only has to consider the new device/protocol/case.</p>
<p>Polymorphism is great. It also kills. Don't be afraid to just *clone* instead. :-)</p>
<p>(Btw, this is why my Go version of SP protocols will never have support for ØMQ. If someone wants that functionality in Go, they should just copy my project, modify it for ØMQ, and make no effort to preserve functionality with SP/nanomsg. (I might actually do that work myself.)</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998793)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998793)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998793" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998793)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998793)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=7196533b5aa2fc52c21517218723b2c4&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Garrett D'Amore (guest)</span>, <span class="odate time_1395798938 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 01:55</span>
		</div>
	</div>
 
                
        
            </div>
 

	
					
      
    <div class="post-container" id="fpc-1998925">
                      
		<div class="post" id="post-1998925">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1998925)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1998925">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1395818820 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 07:27</span>
														</div>
			</div>
			<div class="content" id="post-content-1998925">
									

<p>Great example, thanks!</p>
<p>The interesting topic to think about is what tools do we have in our bag to deal with spaghetti domains. Only two of them come to mind readily: limiting the scope (&quot;we'll deal with only this little part of the domain and deliberately ignore the rest&quot;) and using copy+paste instead of more sophisticated problem decomposition tools.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1998925)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1998925)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1998925" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1998925)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1998925)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1395818820 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">26 Mar 2014 07:27</span>
		</div>
	</div>
 
                
        
            </div>
 

	
					
      
    <div class="post-container" id="fpc-1999955">
                      
		<div class="post" id="post-1999955">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,1999955)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-1999955">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=bedcff1a490bc2e248b0d9395d9876fe&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Paul Hammant (guest)</span> <span class="odate time_1395951246 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Mar 2014 20:14</span>
														</div>
			</div>
			<div class="content" id="post-content-1999955">
									

<p>Would refactorings - &quot;introduce interface&quot;, and so on work here? Code in a predicate to that abstraction so the right one can be activated, and avoid the if/else stuff. Not a new idea at all - <a href="https://www.jetbrains.com/idea/webhelp/extract-interface.html">https://www.jetbrains.com/idea/webhelp/extract-interface.html</a> - relates to plugins, DI, and also BranchByAbstraction (but that last is more about migration).</p>
<p>And yes, I've worked in spaghetti code before now.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,1999955)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,1999955)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-1999955" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,1999955)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,1999955)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=bedcff1a490bc2e248b0d9395d9876fe&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Paul Hammant (guest)</span>, <span class="odate time_1395951246 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Mar 2014 20:14</span>
		</div>
	</div>
 
                
        
            </div>
 

	
					
      
    <div class="post-container" id="fpc-2000546">
                      
		<div class="post" id="post-2000546">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2000546)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2000546">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=854a6e5388b146e936c1bc372a99ec7b&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Johnicholas (guest)</span> <span class="odate time_1396026971 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">28 Mar 2014 17:16</span>
														</div>
			</div>
			<div class="content" id="post-content-2000546">
									

<p>The blog post is confusing, because it sounds like it is arguing for a conclusion something like &quot;the domain is spaghetti-shaped, so the code should be spaghetti-shaped&quot;. Some commenters are trying to point out how silly that argument is. Clearly &quot;the domain is red, so the code should be red&quot; or &quot;the domain is visual, so the code should be visual&quot; or &quot;the domain is three-dimensional, so the code should be three-dimensional&quot; are analogous, false claims.</p>
<p>In fact, we should be focusing on the dynamics of the domain - how did it change in the past, and how do we anticipate it changing in the future, and which software architectures support which kinds of dynamics.</p>
<p>For example, imagine a domain that changes for various complicated, human reasons that nevertheless preserves a particular rigid concept like a buoy floating on choppy water. Factoring that rigid concept out into some structure (a function, class, module, whatever) is probably a good thing to do.</p>
<p>Similarly, when the blog post tells about a change that cross-cuts the existing architecture, leading to no good short-term options for evolving the system, the problem is that the (badly refactored) architecture mismatches the dynamics of the domain. However, that is not an argument FOR spaghetti code - because the spaghetti code may also mismatch the dynamics of the domain, and there may be other (more modular) architectures that do match the dynamics of the domain.</p>
<p>For example, if there are a mountain of shipped devices that will not be upgraded, and we need to be compatible with, then the existence of that mountain may be a durable aspect of the domain, and it may be appropriate to factor out a structure (function, class, module, whatever) to deal with it. If there is a big, standards-bending vendor in this market, they may be a durable aspect of the domain, and it may be appropriate to factor out a structure to specialize in that vendor's peculiarities.</p>
<p>Focus on the history of changes and likely stabilities in the domain in order to refactor towards maintainability; you cannot just &quot;follow your nose&quot; and narrow your gaze to the source code.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2000546)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2000546)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2000546" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2000546)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2000546)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=854a6e5388b146e936c1bc372a99ec7b&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Johnicholas (guest)</span>, <span class="odate time_1396026971 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">28 Mar 2014 17:16</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-2000618">
                      
		<div class="post" id="post-2000618">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2000618)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2000618">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1396033793 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">28 Mar 2014 19:09</span>
														</div>
			</div>
			<div class="content" id="post-content-2000618">
									

<p>Yes. If there's an invariant in the domain it should be factored out in the software. But how is that blog-worthy? It's a common wisdom.</p>
<p>What developers often forget about though &#8212; and what is therefore worth pointing out &#8212; is that after factoring out all the invariants there remains an unfactorable residue, which happens to be pretty big in some unfortunate domains.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2000618)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2000618)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2000618" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2000618)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2000618)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1396033793 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">28 Mar 2014 19:09</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-2002451">
                      
		<div class="post" id="post-2002451">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2002451)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2002451">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=854a6e5388b146e936c1bc372a99ec7b&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Johnicholas (guest)</span> <span class="odate time_1396287059 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">31 Mar 2014 17:30</span>
														</div>
			</div>
			<div class="content" id="post-content-2002451">
									

<p>This blog posts's claim is that spaghetti code is the correct implementation of a domain with complex, human dynamics.</p>
<p>It supports that claim with an illustrative example, where someone (foolishly) refactors a spaghetti implementation to a structure that does not reflect the complex, human dynamics, and then suffers thereby.</p>
<p>However, the illustrative example only supports the weaker proposition &quot;code structure should reflect the dynamics of how the code changes&quot;.</p>
<p>In particular, I think a rule-engine might be more appropriate than spaghetti code for a domain that changes &quot;legalistically&quot;. Alternatively, reifying vendors might be appropriate for a domain (such as device drivers?) where large vendors are long-term stable aspects of the domain.</p>
<p>Essentially nothing in the real world is unfactorable. Your example doesn't have a correct architecture ONLY because it is a contrived example that does not have the patterned dynamics that occur in real-world domains - and &quot;doesn't have a correct architecture&quot; is not the same as &quot;spaghetti code is the best available architecture&quot;.</p>

							</div>

								
					
						<div class="options">
				
																					<a href="javascript:;" onclick="togglePostOptions(event,2002451)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2002451" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2002451)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2002451)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=854a6e5388b146e936c1bc372a99ec7b&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Johnicholas (guest)</span>, <span class="odate time_1396287059 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">31 Mar 2014 17:30</span>
		</div>
	</div>
 
                
        
            </div>
 
                      
    <div class="post-container" id="fpc-2002848">
                      
		<div class="post" id="post-2002848">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2002848)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2002848">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1396330050 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">01 Apr 2014 05:27</span>
														</div>
			</div>
			<div class="content" id="post-content-2002848">
									

<p>The things that evolve are more or less unfactorable: Human anatomy. Body of law. Politics. Telco protocols. The old town of Marrakesh.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2002848)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2002848)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2002848" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2002848)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2002848)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263535" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1396330050 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">01 Apr 2014 05:27</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 
            </div>
 

	
					
      
    <div class="post-container" id="fpc-2000593">
                      
		<div class="post" id="post-2000593">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2000593)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2000593">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=56104e66c54b9fbc0ec9dab4f780c968&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Joe (guest)</span> <span class="odate time_1396031772 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">28 Mar 2014 18:36</span>
														</div>
			</div>
			<div class="content" id="post-content-2000593">
									

<p>It looks all right but then it turns out that foosoft=4 is already being used to identify yet another vendor who uses sequence numbering step of 2. The beautification have actually broken the product!</p>
<p>If that was the case, the original product would have already been broken, since there is no explicit case for foosoft=4 to return old_seq+2, it would return old_seq+1. In any case, it seems that you're looking at the problem in the wrong way. The way you changed the function changes its meaning. You're taking a supposed vendor &quot;id,&quot; and using it as something else: a sequence interval. Refactoring is meant to change the code to be more readable without changing its function.</p>
<p>This seems like a poor example.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2000593)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2000593)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2000593" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2000593)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2000593)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=56104e66c54b9fbc0ec9dab4f780c968&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Joe (guest)</span>, <span class="odate time_1396031772 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">28 Mar 2014 18:36</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-2008887">
                      
		<div class="post" id="post-2008887">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2008887)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2008887">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=a66e92843b9e4592de6579f77463b17f&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>weethomas (guest)</span> <span class="odate time_1396997777 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">08 Apr 2014 22:56</span>
														</div>
			</div>
			<div class="content" id="post-content-2008887">
									

<p>Ha, you've not actually experienced this have you? The original product doesn't need to be broken. You may just be a small player in a big world. If you make a product that interacts with other products over a common standard and big players make a mistake or a specific non-standard implementation and your customers need your product to work with them, then you have to play ball. Even if it means that the big kahuna introduced a change that broke what was otherwise a working product.</p>
<p>Imagine about 7 years ago, you need to write code to communicate over one of the non-CAN OBD-II protocols. You grab the spec, rent a lot of vehicles, then write your implementation. In the meantime, GM makes a change which breaks your code.</p>
<p>You don't make cars, you make an add-on that's supposed to work with cars. Do you really think you're going to convince your customers that it's GMs implementation that's broken? No. Here's the problem, a few other car companies also have slight tweaks that differ from the standard. Again, you can't just simply finger them as the bad guys. So, you add some spaghetti to your code and make it work.</p>
<p>In case you think this is a contrived example, it's not. I've been the poor engineer in the sad position of writing code to hack around major car companies' actual implementation of something vs what the standard says.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2008887)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2008887)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2008887" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2008887)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2008887)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=a66e92843b9e4592de6579f77463b17f&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>weethomas (guest)</span>, <span class="odate time_1396997777 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">08 Apr 2014 22:56</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 

	
					
      
    <div class="post-container" id="fpc-2001207">
                      
		<div class="post" id="post-2001207">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2001207)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2001207">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=5e0ef511cedaa645de9ea38b8ee2a320&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Da Critique (guest)</span> <span class="odate time_1396120104 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">29 Mar 2014 19:08</span>
														</div>
			</div>
			<div class="content" id="post-content-2001207">
									

<p>I opine that blaming a domain spaghetti cannot be a sufficient reason to let the code be spaghetti. To give an analogy, just because the ground below is uneven cannot mean that a civil engineer can erect an uneven structure - it would just collapse.</p>
<p>Speaking of chaos in human-defined concepts like law, telecom stuff etc, and the domains you might have worked in, they surely cannot as much chaotic as real life phenomena itself, where we have come of an age trying to employ machine-learning techniques to bring order, but not give in, to the 'Spaghetti' nature and immense chaos of enormous amounts data being churned.</p>
<p>Engineering need to be based on principles and facts and always should be an endeavor to bring order to chaos - if your code that is split into multiple functions is becoming unwieldy, it surely is asking for a major overhauling or perhaps reached a limiting point(You can't keep adding floors to build an edifice of 100 floors with a foundation for 10 floors), in which case, you either stop working on it further or clone new components as Mr. Garrett D'Amore suggests, but can never relapse into having 1500 line functions, which, evidently is unwieldier.</p>
<p>The argument in favor of having 1500 lines of code referring to some 'Spaghetti' domains is apparently myopic and untenable - instructions to computer, either low-level or high-level ought to be organized to be simple and elegant.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2001207)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2001207)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2001207" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2001207)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2001207)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=5e0ef511cedaa645de9ea38b8ee2a320&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Da Critique (guest)</span>, <span class="odate time_1396120104 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">29 Mar 2014 19:08</span>
		</div>
	</div>
 
                
                	


        
                      
    <div class="post-container" id="fpc-2008892">
                      
		<div class="post" id="post-2008892">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2008892)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2008892">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=a66e92843b9e4592de6579f77463b17f&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>weethomas (guest)</span> <span class="odate time_1396998166 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">08 Apr 2014 23:02</span>
														</div>
			</div>
			<div class="content" id="post-content-2008892">
									

<p>I think you are forgetting the definition of spaghetti code.</p>
<p>Let me give you a trivial, but real example.</p>
<p>You write code for a product that interacts with other products using a published standard. Your product costs $. Another manufacturer's product, which almost all your customers use and you need to interoperate, costs $$$.</p>
<p>Other manufacturer makes a breaking change. You don't know when they're going to issue a fix. But, you do know, given a choice over whether to trash other manufacturer or trash your product and use a competitor, customers will simply dump your product.</p>
<p>What do you do?</p>
<p>You can take the high road and say to yourself, &quot;there is no reason for spaghetti code&quot; and go out of business. Or, you can add in a line of code to handle this one off exception and keep trucking.</p>
<p>By definition, that one off line of code (or lines) that exists solely for that one off corner case is spaghetti code. I suppose you could just pretend it's now part of the problem domain and un-spaghetti it.</p>
<p>But since when other people look at it, they will instantly recognize it as spaghetti code, your decision to redefine terminology doesn't mean much.</p>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2008892)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2008892)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2008892" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2008892)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2008892)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=a66e92843b9e4592de6579f77463b17f&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>weethomas (guest)</span>, <span class="odate time_1396998166 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">08 Apr 2014 23:02</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 


<div class="pager"><span class="pager-no">page 1 of 2</span><span class="current">1</span><span class="target"><a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadPostsModule.listeners.updateList(2)">2</a></span><span class="target"><a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadPostsModule.listeners.updateList(2)">next &raquo;</a></span></div>
</div>

        <a href="javascript:;" id="new-post-button" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.newPost(event,null)"
      style="display:  none ; margin-bottom:1em"
    >Add a New Comment</a>


    <div id="new-post-form-container">
        <div id="new-post-preview-div" style="display: none">
            <h1>Post preview:</h1>
            <div class="post-container"></div>
            <div></div>
            <a href="javascript:;" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.closePreview(event)" class="btn btn-danger">Close preview</a>
        </div>

        <div id="new-post-div" class="well">
            <form id="new-post-form" onkeypress="return OZONE.utils.disableEnterKey(event)">
                <input type="hidden" name="threadId" value="831104"/>
                <input type="hidden" name="parentId" value=""/>
                                    <table class="guest-commenting">
                        <tr>
                            <td><input class="text form-control" name="guestName" type="text" maxlength="30" value="" title="Name"/></td>
                            <td>or <a href="#action:login">Sign in as Wikidot user</a></td>
                        </tr>
                        <tr>
                            <td><input class="text form-control" name="guestEmail" type="text" maxlength="50" value="" title="E-mail address"/></td>
                            <td>(will not be published)</td>
                        </tr>
                    </table>
                                <div><textarea id="np-text" name="source" rows="10" cols="50" class="form-control"></textarea></div>
                <div class="change-textarea-size">
                    <a href="javascript:;" onclick="WIKIDOT.utils.changeTextareaRowNo('np-text',-5)">-</a>
                    <a href="javascript:;" onclick="WIKIDOT.utils.changeTextareaRowNo('np-text',5)">+</a>
                </div>
                <div class="edit-help-34">
                    Help: <a href="http://www.wikidot.com/doc:quick-reference" target="_blank">wiki text quick reference</a>                </div>
                                
                <div id="edit-post-captcha"></div>
                
                <div class="buttons alignleft">
                    <input class="btn btn-danger btn-small btn-sm" type="button" value="Cancel" id="np-cancel" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.cancel(event)"/>
                    <input class="btn btn-default btn-small btn-sm" type="button" value="Preview" id="np-preview" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.preview(event)"/>
                    <input class="btn btn-primary btn-small btn-sm" type="button" value="Post it" id="np-post" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.save(event)"/>
                </div>
                    
            </form>
        </div>	

    </div> 
            <script type="text/javascript">
            
            $j(function() {
                WIKIDOT.Editor.init("np-text", "np-editor-panel");
            });
            
        </script>
    
 

<div style="display:none" id="post-options-template">
	<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.showPermalink(event,'%POST_ID%')" class="btn btn-default btn-small btn-sm">Permanent Link</a>
			<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.editPost(event,'%POST_ID%')" class="btn btn-default btn-small btn-sm">Edit</a>
			<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.deletePost(event,'%POST_ID%')" class="btn btn-danger btn-small btn-sm">Delete</a>
</div>
	
			</div>
	
	
	
</div></div>

                    </div>

                    


                    



                    

                    <div id="page-info-break"></div>
                    
                        <div id="page-options-container">
                            
                        </div>
                    
                    <div id="action-area" style="display: none;"></div>
                </div>
            </div>
            
            
            
            <div id="footer" style="display: block; visibility: visible;">
                <div class="options" style="display: block; visibility: visible;">
    <a href="http://www.wikidot.com/doc" id="wikidot-help-button">Help</a>
    &nbsp;|
    <a href="http://www.wikidot.com/legal:terms-of-service" id="wikidot-tos-button">Terms of Service</a>
    &nbsp;|
    <a href="http://www.wikidot.com/legal:privacy-policy" id="wikidot-privacy-button">Privacy</a>
    &nbsp;|
    <a href="javascript:;" id="bug-report-button" onclick="WIKIDOT.page.listeners.pageBugReport(event)">Report a bug</a>
    &nbsp;|
    <a href="javascript:;" id="abuse-report-button" onclick="WIKIDOT.page.listeners.flagPageObjectionable(event)">Flag as objectionable</a>
</div>
Powered by <a href="http://www.wikidot.com">Wikidot.com</a> 
            </div>
            
                <div id="license-area" class="license-area">
                    Unless otherwise stated, the content of this page is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 License</a>
                </div>
            
            
            



            <div id="extrac-div-1"><span></span></div><div id="extrac-div-2"><span></span></div><div id="extrac-div-3"><span></span></div>
            
            
            
            
                
            
        </div>
        
    </div>
<!-- These extra divs/spans may be used as catch-alls to add extra imagery. -->
<div id="extra-div-1"><span></span></div><div id="extra-div-2"><span></span></div><div id="extra-div-3"><span></span></div>
<div id="extra-div-4"><span></span></div><div id="extra-div-5"><span></span></div><div id="extra-div-6"><span></span></div>
</div>




</div>
<div id="dummy-ondomready-block" style="display: none;" ></div>
    <!-- Google Analytics load -->
    <script type="text/javascript">
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <!-- Quantcast -->
    <script type="text/javascript">
    _qoptions={
        qacct:"p-edL3gsnUjJzw-"
    };
    (function() {
        var qc = document.createElement('script'); qc.type = 'text/javascript'; qc.async = true;
        qc.src = ('https:' == document.location.protocol ? 'https://secure' : 'http://edge') + '.quantserve.com/quant.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(qc, s);
    })();
    </script>
    <noscript>
        <img src="http://pixel.quantserve.com/pixel/p-edL3gsnUjJzw-.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/>
    </noscript>




<div id="page-options-bottom-tips" style="display: none;">
    <div id="edit-button-hovertip">
        Click here to edit contents of this page.    </div>
</div>
<div id="page-options-bottom-2-tips"  style="display: none;">
    <div id="edit-sections-button-hovertip">
        Click here to toggle editing of individual sections of the page (if possible).         Watch headings for an &quot;edit&quot; link when available.    </div>
    <div id="edit-append-button-hovertip">
        Append content without editing the whole page source.    </div>
    <div id="history-button-hovertip">
        Check out how this page has evolved in the past.    </div>
    <div id="discuss-button-hovertip">
        If you want to discuss contents of this page - this is the easiest way to do it.    </div>
    <div id="files-button-hovertip">
        View and manage file attachments for this page.    </div>
    <div id="site-tools-button-hovertip">
        A few useful tools to manage this Site.    </div>
    <div id="backlinks-button-hovertip">
        See pages that link to and include this page.    </div>
    <div id="rename-move-button-hovertip">
        Change the name (also URL address, possibly the category) of the page.    </div>
    <div id="view-source-button-hovertip">
        View wiki source for this page without editing.    </div>
    <div id="parent-page-button-hovertip">  
        View/set parent page (used for creating breadcrumbs and structured layout).    </div>
            <div id="abuse-report-button-hovertip">
            Notify administrators if there is objectionable content in this page.        </div>
        <div id="bug-report-button-hovertip">
            Something does not work as expected? Find out what you can do.        </div>
        <div id="wikidot-help-button-hovertip">
            General Wikidot.com documentation and help section.        </div>
        <div id="wikidot-tos-button-hovertip">
            Wikidot.com Terms of Service - what you can, what you should not etc.        </div>
        <div id="wikidot-privacy-button-hovertip">
            Wikidot.com Privacy Policy.          
        </div>
    </div>
</body>
</html>