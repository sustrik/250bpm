<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>Code Generation &amp; Visual Smog in Code (part II) - 250bpm</title>
    
    	<script type="text/javascript" src="http://www.wikidot.com/default__flow/login__CustomDomainScript?site_id=148706"></script>

    
    <script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--javascript/init.combined.js"></script>
    <script  type="text/javascript">
        var URL_HOST = 'www.wikidot.com';
        var URL_DOMAIN = 'wikidot.com';
        var USE_SSL =  true ;
        var URL_STATIC = 'http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9';
        // global request information
        
        var WIKIREQUEST = {};
        WIKIREQUEST.info = {};
        
        WIKIREQUEST.info.domain = "250bpm.com";
        WIKIREQUEST.info.siteId = 148706;
        WIKIREQUEST.info.siteUnixName = "250bpm";
        WIKIREQUEST.info.categoryId = 2550760;
        WIKIREQUEST.info.themeId = 18520;
        WIKIREQUEST.info.requestPageName = "blog:38";
        OZONE.request.timestamp = 1594263536;
        OZONE.request.date = new Date();
        WIKIREQUEST.info.lang = 'en';
                WIKIREQUEST.info.pageUnixName = "blog:38";
        WIKIREQUEST.info.pageId = 22109091;
                        WIKIREQUEST.info.lang = "en";
        OZONE.lang = "en";
        var isUAMobile = !!/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    </script>
    
    


    
        <script  type="text/javascript">
    
        require.config({
            baseUrl: URL_STATIC + '/common--javascript',
            paths: {
                'jquery.ui': 'jquery-ui.min',
                'jquery.form': 'jquery.form'
            }
        });
    
    </script>
    
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
            
    
    
    
    
    <meta http-equiv="content-language" content="en"/>
    <script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--javascript/WIKIDOT.combined.js"></script>
        
    
    <style type="text/css" id="internal-style">
        
        /* modules */
        
                
        /* theme */
                    @import url(http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--theme/base/css/style.css);
                    @import url(http://250bpm.wdfiles.com/local--theme/250bpm/style.css);
            </style>
    
        
        
        
    <link rel="shortcut icon" href="/local--favicon/favicon.gif"/>
    <link rel="icon" type="image/gif" href="/local--favicon/favicon.gif"/>
    
            <link rel="apple-touch-icon" href="/common--images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="/common--images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="/common--images/apple-touch-icon-114x114.png" />
        
        
            <link rel="alternate" type="application/wiki" title="Edit this page" href="javascript:WIKIDOT.page.listeners.editClick()"/>
    
        <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-18234656-1']);
        _gaq.push(['_setDomainName', 'none']);
        _gaq.push(['_setAllowLinker', true]);
        _gaq.push(['_trackPageview']);

        _gaq.push(['old._setAccount', 'UA-68540-5']);
        _gaq.push(['old._setDomainName', 'none']);
        _gaq.push(['old._setAllowLinker', true]);
        _gaq.push(['old._trackPageview']);

                _gaq.push(['userTracker._setAccount', 'UA-3207370-9']);
        _gaq.push(['userTracker._trackPageview']);
            </script>
    
    <script type="text/javascript">
        window.google_analytics_uacct = 'UA-18234656-1';
        window.google_analytics_domain_name = 'none';
    </script>
    
        <link rel="manifest" href="/onesignal/manifest.json" />
    <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" acync=""></script>
    <script>
        var OneSignal = window.OneSignal || [];
        OneSignal.push(function() {
          OneSignal.init({
            appId: null,
          });
        });
    </script>
        
<link rel="alternate" type="application/rss+xml" title="Comments for the page &quot;Code Generation &amp; Visual Smog in Code (part II)&quot;" href="/feed/page/comments-22109091.xml"/><script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/ForumCommentsModule.js"></script>
<script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/ForumViewThreadModule.js"></script>
<script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/ForumViewThreadPostsModule.js"></script>
<script type="text/javascript" src="http://d3g0gp89917ko0.cloudfront.net/v--3e3a6f7dbcc9/common--modules/js/forum/sub/ForumNewPostFormModule.js"></script>
</head>
<body id="html-body">
<div id="skrollr-body">
<a name="page-top"></a>





<div id="container-wrap-wrap">
    <div id="container-wrap">
        <div id="container">
            <div id="header">
              <h1><a href="/"><span>250bpm</span></a></h1>
                
                
                <!-- google_ad_section_start(weight=ignore) -->
                
                <div id="search-top-box" class="form-search">
    <form id="search-top-box-form" action="dummy" class="input-append">
        <input id="search-top-box-input" class="text empty search-query" type="text" size="15" name="query" value="Search this site" onfocus="if(YAHOO.util.Dom.hasClass(this, 'empty')){YAHOO.util.Dom.removeClass(this,'empty'); this.value='';}"/><input class="button btn" type="submit" name="search" value="Search"/>
    </form>
</div>
                
                
                    <div id="top-bar">
                        

<ul>
<li><a href="/">Home</a></li>
<li><a href="https://github.com/sustrik/cartesian">Cartesian</a></li>
<li><a href="http://libdill.org">Libdill</a></li>
<li><a href="http://nanomsg.org">Nanomsg</a></li>
<li><a href="https://github.com/sustrik/tiles">Tiles</a></li>
<li><a href="http://zero.mq">ZeroMQ</a></li>
<li><a href="/contact">Contact</a></li>
</ul>

                    </div>
                
                <div id="login-status"><a href="javascript:;" onclick="WIKIDOT.page.listeners.createAccount(event)" class="login-status-create-account btn">Create account</a> <span>or</span> <a href="javascript:;" onclick="WIKIDOT.page.listeners.loginClick(event)" class="login-status-sign-in btn btn-primary">Sign in</a> </div>
                <div id="header-extra-div-1"><span></span></div><div id="header-extra-div-2"><span></span></div><div id="header-extra-div-3"><span></span></div>
            </div>
            
            <div id="content-wrap">
                
                    <div id="side-bar">
                        


                        


                        


                    </div>
                
                
                <!-- google_ad_section_end -->
                
                <div id="main-content">
                    <div id="action-area-top"></div>
                    
                    
                        <div id="page-title">
                            Code Generation &amp; Visual Smog in Code (part II)
                        </div>
                    

                    

                    



                    <div id="page-content">
                        

<div style="width:50em"><div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Previous:</strong> <a href="/blog:37">Code Generation &amp; Visual Smog in Code (part I)</a></p>
</div>
    
    
    
    </div><div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Next:</strong> <a href="/blog:39">Design of PUB/SUB subsystem in Ã˜MQ</a></p>
</div>
    
    
    
    </div>
<p>(continued from the previous episode&#8230;)</p>
<h3 id="toc0"><span>14.</span></h3>
<p>Now that we've dealt with repetitive code and escape sequences, here comes the actual meat of the problem: The indentation.</p>
<p>Indentation is a way to employ the 2D shape recognition capability built into the human brain in the service of understanding the code. If the indentation is broken, our innate 2D scanner switches off and we are left with having to understand the structure of the code the hard way, the way the compilers do. This off-switch of programmer's 2D scanner is used, for example, by the obfuscation technique that removes all the layout and present the whole program as a single line of code or as an ASCII art.</p>
<p>As far as code generation is concerned, there are two distinct problems to deal with: First, generator's source code has to be indented, second, the generated code has to be indented. As we'll see later on the two are interconnected in a subtle manner. However, for now, let's just note that the first problem is much more important to solve, as the generated code is mostly meant to be consumed by a machine and thus doesn't have to be particularly pretty.</p>
<h3 id="toc1"><span>15.</span></h3>
<p>Indenting of the code generator's source code is a hard problem and one that cannot be solved by technical means.</p>
<p>I am aware that when one asserts that something cannot be done he's just asking to be exposed as an idiot by someone who actually does it. However, let's consider my argument first:</p>
<p>The code generator and the generated program are two very distinct algorithms. After all, the first just concatenates some strings while the latter controls, say, a shoe factory.</p>
<p>That being a fact, their internal logical structure is going to be very different. Thus, if we want to use indentation to expose the logical structure of both, we are going to end up with two unrelated interleaved indentations:</p>
<div class="code">
<pre>
<code>.foo = bar;
if(a == 0)
.++foo;
    if(b == 0)
.if (foo == 3)
.    bar = 0;
        if(c == 0)
.++bar;
        end
.foo = 0;
    end
end</code>
</pre></div>
<h3 id="toc2"><span>16.</span></h3>
<p>For all I can say, the problem is inherent to interleaving two distict programs and there's no way to twist it in such a way as to end up with a single indentation and yet preserve the ability to 2D-scan both programs.</p>
<p>So, let's accept double indentation as a fact. Is there a way to preserve 2D-scanability under such circumstances?</p>
<p>Think about it for a while! What we need is to see two different things in a single chunk of code&#8230;</p>
<p>And by now those with some psychology background should recall they have encountered something similar in the past.</p>
<p>And yes, you are right. It's the <a href="https://en.wikipedia.org/wiki/Necker%27s_cube">Necker cube</a>!</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/necker.png" alt="necker.png" class="image" /></div>
<p>Necker cube is a single drawing that can be interpreted in two different ways:</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/necker2.png" alt="necker2.png" class="image" /></div>
<p>From our point of view the most important property of Necker cube is that altough the observer can't see both cubes at the same time, he can switch between the two representations at will.</p>
<p>What we need to do is to achieve the same flip-flop effect with the doubly-indented code.</p>
<p>Switching between the two cubes happens by imagining that some lines are invisible (the dotted lines on the picture above). Sadly, the same trick doesn't really work with the ribosome source. You can try to imagine that the lines startng with a dot in the code sample above are invisible and focus only on the non-dotted lines. I expect it will give you hard time and the results won't be spectacular.</p>
<p>We can help our imagination though by using our colour preception capability. Here's the syntax-highlighted version of the code. Focus on the black code first, then try to switch to the blue code:</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/vim1.png" alt="vim1.png" class="image" /></div>
<p>Have you been able to achieve the Necker-cube-like flip-flop effect? Have you seen black well-indented code first and blue well-indented code later?</p>
<p>Maybe not. It's not that easy. However &#8212; and I've tested it myself &#8212; if you spend an hour writing the code highlighted like that you'll get much better at switching between the two representations.</p>
<h3 id="toc3"><span>17.</span></h3>
<p>The syntax highlighting can be thought of as a computer-aided Necker cube effect. But why limit ourselves to plain old syntax highlighting? Surely, computer must be capable of doing more to help us.</p>
<p>When you put aside options that are technically unfeasible at the moment, like using our innate 3C recognition capability (control language on the foreground, generated language on the background), we can resort to yet more syntax highlighting.</p>
<p>Specifically, the computer can simulate the flip-flop effect for us.</p>
<p>If you install vim plugin for ribosome, by default you will be see the DNA files in black/blue colouring, as shown above.</p>
<p>However, by pressing F3, the control language will get full Ruby syntax colouring while the generated language will be shaded, so as not to distract from the perception of the control language:</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/vim2.png" alt="vim2.png" class="image" /></div>
<p>By pressing F4 you'll get exactly the opposite effect. Control language will be shaded and the generated language will be properly syntax-highlighted (you'll have to let vim know what language you are generating though):</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/vim4.png" alt="vim4.png" class="image" /></div>
<p>By alternatively pressing F3 and F4 you are in fact generating the full-blown computer-aided Necker cude effect.</p>
<h3 id="toc4"><span>18.</span></h3>
<p>We'll return to the indentation of ribosome source later, but now let's have a look at the indentation of the generated code.</p>
<p>As already said, it's not that important, because it's something that will be processed by a machine anyways. There are two caveats though:</p>
<ol>
<li>What if we are generating Python program? If so, identation must be done correctly, otherwise the program won't work.</li>
<li>What if the output is meant to be human-readable anyway? If so, indentation is a must. Non-indented program in a non-readable program.</li>
</ol>
<h3 id="toc5"><span>19.</span></h3>
<p>To understand the problem we are dealing with here, consider the following program:</p>
<div class="code">
<pre>
<code>def greet(name)
.printf (&quot;Hello, &quot;);
.printf (&quot;@{name}!&quot;);
.printf (&quot;\n&quot;);
end

.@{greet(&quot;Alice&quot;)}
.if (is_bob_present) {
.    @{greet(&quot;Bob&quot;)}
.}</code>
</pre></div>
<p>The output of such program &#8212; if done naively &#8212; would look like this:</p>
<div class="code">
<pre>
<code>printf (&quot;Hello, &quot;);
printf (&quot;Alice!&quot;);
printf (&quot;\n&quot;);
if (is_bob_present) {
    printf (&quot;Hello, &quot;);
printf (&quot;Bob!&quot;);
printf (&quot;\n&quot;);
}</code>
</pre></div>
<p>Note the mis-indentation in the lines 6 and 7! And with large non-toy programs, the problem will become ubiquitous &#8212; there rarely will be a line that's well indented.</p>
<h3 id="toc6"><span>20.</span></h3>
<p>If you run the above code with ribosome, the result will be correctly indented though. So what's going on here?</p>
<p>Before diving into technical details, recall how you deal with the same problem when you are editing code by hand.</p>
<p>While most of the time you spend editing individual lines of code, when the indentation is involved you often select a whole block of code and move it to the left or to the right as needed. Individual editors provide different means to make this operation easy to perform. For example, in most WYSIWYG editors selecting a block of code and pressing Tab moves the block to the right.</p>
<p>Can the code generator do a similar thing for us?</p>
<p>And the answer is, obviously, yes. The only thing we have to do is to stop thinking in terms of lines of code and rather think about rectangular blocks of code.</p>
<h3 id="toc7"><span>21.</span></h3>
<p>Technically, all string literals are trated as simple one-line block of code, while output of any embedded expression is treated as a rectangular block of code, whether is consists one line or mulitple lines.</p>
<p>The the following source code:</p>
<div class="code">
<pre>
<code>.    @{greet(&quot;Bob&quot;)}</code>
</pre></div>
<p>Can be graphically represented like this:</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/ribo9.png" alt="ribo9.png" class="image" /></div>
<p>There's a simple literal block of 4 space characters on the left and a 3 line long block generated by function <em>greet</em> on the right.</p>
<h3 id="toc8"><span>22.</span></h3>
<p>Note how this system works in recursive manner. You can use it to properly indent pieces of code within your program, but your program as a whole can be treated as a single block of code and indented as needed:</p>
<div class="code">
<pre>
<code>def greet(name)
.printf (&quot;Hello, &quot;);
.printf (&quot;@{name}!&quot;);
.printf (&quot;\n&quot;);
end

def greetall()
.@{greet(&quot;Alice&quot;)}
.if (is_bob_present) {
.    @{greet(&quot;Bob&quot;)}
.}
end

.#include &lt;stdio.h&gt;
.
.int main() {
.    @{greetall}
.    return 0;
.}</code>
</pre></div>
<p>And here's the output, showing blocks of code as they were processed on different levels of the call stack:</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/ribo10.png" alt="ribo10.png" class="image" /></div>
<h3 id="toc9"><span>23.</span></h3>
<p>All the above can be boiled down to a single leading principle: It's not the callee's task to manage the layout of the block being generated. Rather, it's caller's responsibility to place the block to the appropriate position.</p>
<p>What does that mean for the whitespace in the generated block? If every line of the block starts with four spaces, should we carefully preserve them, or should we rather say that it's not the callee's job to care about indentation and ignore the whitespace as random noise?</p>
<p>In ribosome I've opted for the latter choice:</p>
<div class="image-container aligncenter"><img src="http://250bpm.wdfiles.com/local--files/blog:38/ribo11.png" alt="ribo11.png" class="image" /></div>
<p>Note how the whitespace on the left is not part of the generated block!</p>
<h3 id="toc10"><span>24.</span></h3>
<p>While this choice looks somehow arbitrary, it has not entirely consequence for formating of the DNA source file:</p>
<p>Given that any whitespace on the left will be ignored, we can add arbitrary whitespace in each function to re-synchronise divergent indenting between the control language and the generated language:</p>
<div class="code">
<pre>
<code>if(a == 0)
.i += 1;
    if(b == 0)
.i += 2;
        if(c == 0)
.i += 3;
            if(d == 0)
.i += 4;
            end
        end
    end
end</code>
</pre></div>
<p>In lines 7 and 8, the control language is mis-aligned with the gererated language by 12 characters. Now consider what happens if we split the code into two functions:</p>
<div class="code">
<pre>
<code>def foo()
.   i += 2;
    if(c == 0)
.   i += 3;
        if(d == 0)
.   i += 4;
        end
   end
end

if(a == 0)
.i += 1;
    if(b == 0)
.@{foo}
    end
end</code>
</pre></div>
<p>As can be seen, the divergence doesn't exceed 4 characters here.</p>
<h3 id="toc11"><span>25.</span></h3>
<p>Finally, few words for the biologically savvy.</p>
<p>Of course, besides being an vague allusion to Ruby, ribosome's name refers to the molecular machine within the living cell, one that translates RNA into proteins.</p>
<p>And of course, ribosomes process RNA, not DNA.</p>
<p>So, if we want to stretch the biological metaphor further, ribosome tool plays role of both RNA polymerase and the ribosome itself. In fact, the tool works in two steps (invisible to the user):</p>
<ol>
<li>First step compiles .dna file into a code generator written in pure ruby (it has .rna extension!)</li>
<li>Second step runs the code generator to produce the actual generated code.</li>
</ol>
<p><strong>Martin SÃºstrik, April 27th, 2014</strong></p>
<div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Previous:</strong> <a href="/blog:37">Code Generation &amp; Visual Smog in Code (part I)</a></p>
</div>
    
    
    
    </div><div class="list-pages-box">    <div class="list-pages-item">


<p><strong>Next:</strong> <a href="/blog:39">Design of PUB/SUB subsystem in Ã˜MQ</a></p>
</div>
    
    
    
    </div>
<div style="height:2em"></div>
<div class="comments-box">
		
	<div class="options" id="comments-options-hidden" style="display: none">
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumCommentsModule.listeners.showComments(event)">Show Comments</a> 
	</div>
		
	<div id="thread-container" class="thread-container" style="margin-top: 1em">
					


<script type="text/javascript">
	WIKIDOT.forumThreadId = 853349;
</script>


	<div class="options" id="comments-options-shown">
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumCommentsModule.listeners.hideComments(event)" class="btn btn-default btn-small btn-sm">Hide All Comments</a> 
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.unfoldAll(event)" class="btn btn-default btn-small btn-sm">Unfold All</a> 
		<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.foldAll(event)" class="btn btn-default btn-small btn-sm">Fold All</a>
	</div>

<div id="thread-container-posts" style="display: none">
    



	
					
      
    <div class="post-container" id="fpc-2020491">
                      
		<div class="post" id="post-2020491">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2020491)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2020491">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=38d2521ec9092c9b8243b7a0bc9bbe50&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Pierre Chapuis (guest)</span> <span class="odate time_1398599062 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Apr 2014 11:44</span>
														</div>
			</div>
			<div class="content" id="post-content-2020491">
									

<p>Why don't you allow identation *before* the dot for generated code lines? Or alternatively allow any number of dots?</p>
<p>So this:</p>
<div class="code">
<pre>
<code>.foo = bar;
if(a == 0)
.++foo;
    if(b == 0)
.if (foo == 3)
.    bar = 0;
        if(c == 0)
.++bar;
        end
.foo = 0;
    end
end</code>
</pre></div>
<p>could become this:</p>
<div class="code">
<pre>
<code>.foo = bar;
if(a == 0)
    .++foo;
    if(b == 0)
        .if (foo == 3)
        .    bar = 0;
        if(c == 0)
            .++bar;
        end
        .foo = 0;
    end
end</code>
</pre></div>
<p>or this:</p>
<div class="code">
<pre>
<code>.foo = bar;
if(a == 0)
.....++foo;
    if(b == 0)
.........if (foo == 3)
.........    bar = 0;
        if(c == 0)
.............++bar;
        end
.........foo = 0;
    end
end</code>
</pre></div>

							</div>

								
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2020491)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2020491)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2020491" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2020491)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2020491)"></a> by <span class="printuser avatarhover"><a href="javascript:;"><img class="small" src="http://www.gravatar.com/avatar.php?gravatar_id=38d2521ec9092c9b8243b7a0bc9bbe50&amp;default=http://www.wikidot.com/common--images/avatars/default/a16.png&amp;size=16" alt=""/></a>Pierre Chapuis (guest)</span>, <span class="odate time_1398599062 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Apr 2014 11:44</span>
		</div>
	</div>
 
                
        
                      
    <div class="post-container" id="fpc-2020496">
                      
		<div class="post" id="post-2020496">
		<div class="long">
			<div class="head">
									<div class="options">
						<a href="javascript:;" onclick="togglePostFold(event,2020496)" class="btn btn-default btn-small btn-sm">Fold</a>
					</div>
								<div class="title" id="post-title-2020496">
																		
															</div>
				<div class="info">
					<span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263536" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span> <span class="odate time_1398599970 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Apr 2014 11:59</span>
														</div>
			</div>
			<div class="content" id="post-content-2020496">
									

<p>The idea was to minimise possible clashes with Ruby.</p>
<p>The assumption was that a dot at the beginning of the line is very rare i Ruby. A dot following a whitespace may be less rare:</p>
<div class="code">
<pre>
<code>foo
    .bar()
    .baz()</code>
</pre></div>
<p>The sequence of multiple dots should be actually viable. Still, I feel like anchoring the generated code to the left is good for readability, i.e. the indentation of the text you see (within a single function) is the same as the one in the output. Kind of wysiwyg principle.</p>
<p>That would not apply, if mutliple dots are allowed:</p>
<div class="code">
<pre>
<code>........a
....b</code>
</pre></div>
<p>Would produce:</p>
<div class="code">
<pre>
<code>a
b</code>
</pre></div>

							</div>

								
							<div class="changes">
					Last edited on <span class="odate time_1398600044 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Apr 2014 12:00</span>
					by <span class="printuser"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>
					<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.showHistory(event,2020496)"><i class="icon-plus"></i> Show more</a>
				</div>
				<div class="revisions" style="display: none"></div>
					
						<div class="options">
				
													<strong><a href="javascript:;" onclick="postReply(event,2020496)" class="btn btn-primary btn-small btn-sm">Reply</a></strong> 
																	<a href="javascript:;" onclick="togglePostOptions(event,2020496)" class="btn btn-default btn-small btn-sm">Options</a>
							</div>
									
			<div id="post-options-2020496" class="options" style="display: none">
			</div>
		</div>
		<div class="short">
							<a class="options btn btn-default btn-mini btn-xs" href="javascript:;" onclick="togglePostFold(event,2020496)" c>Unfold</a>
						<a class="title" href="javascript:;" onclick="togglePostFold(event,2020496)"></a> by <span class="printuser avatarhover"><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;"  ><img class="small" src="http://www.wikidot.com/avatar.php?userid=939&amp;amp;size=small&amp;amp;timestamp=1594263536" alt="martin_sustrik" style="background-image:url(http://www.wikidot.com/userkarma.php?u=939)"/></a><a href="http://www.wikidot.com/user:info/martin-sustrik" onclick="WIKIDOT.page.listeners.userInfo(939); return false;" >martin_sustrik</a></span>, <span class="odate time_1398599970 format_%25e%20%25b%20%25Y%2C%20%25H%3A%25M%7Cagohover">27 Apr 2014 11:59</span>
		</div>
	</div>
 
                
        
            </div>
 
            </div>
 



</div>

        <a href="javascript:;" id="new-post-button" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.newPost(event,null)"
      style="display:  none ; margin-bottom:1em"
    >Add a New Comment</a>


    <div id="new-post-form-container">
        <div id="new-post-preview-div" style="display: none">
            <h1>Post preview:</h1>
            <div class="post-container"></div>
            <div></div>
            <a href="javascript:;" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.closePreview(event)" class="btn btn-danger">Close preview</a>
        </div>

        <div id="new-post-div" class="well">
            <form id="new-post-form" onkeypress="return OZONE.utils.disableEnterKey(event)">
                <input type="hidden" name="threadId" value="853349"/>
                <input type="hidden" name="parentId" value=""/>
                                    <table class="guest-commenting">
                        <tr>
                            <td><input class="text form-control" name="guestName" type="text" maxlength="30" value="" title="Name"/></td>
                            <td>or <a href="#action:login">Sign in as Wikidot user</a></td>
                        </tr>
                        <tr>
                            <td><input class="text form-control" name="guestEmail" type="text" maxlength="50" value="" title="E-mail address"/></td>
                            <td>(will not be published)</td>
                        </tr>
                    </table>
                                <div><textarea id="np-text" name="source" rows="10" cols="50" class="form-control"></textarea></div>
                <div class="change-textarea-size">
                    <a href="javascript:;" onclick="WIKIDOT.utils.changeTextareaRowNo('np-text',-5)">-</a>
                    <a href="javascript:;" onclick="WIKIDOT.utils.changeTextareaRowNo('np-text',5)">+</a>
                </div>
                <div class="edit-help-34">
                    Help: <a href="http://www.wikidot.com/doc:quick-reference" target="_blank">wiki text quick reference</a>                </div>
                                
                <div id="edit-post-captcha"></div>
                
                <div class="buttons alignleft">
                    <input class="btn btn-danger btn-small btn-sm" type="button" value="Cancel" id="np-cancel" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.cancel(event)"/>
                    <input class="btn btn-default btn-small btn-sm" type="button" value="Preview" id="np-preview" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.preview(event)"/>
                    <input class="btn btn-primary btn-small btn-sm" type="button" value="Post it" id="np-post" onclick="WIKIDOT.modules.ForumNewPostFormModule.listeners.save(event)"/>
                </div>
                    
            </form>
        </div>	

    </div> 
            <script type="text/javascript">
            
            $j(function() {
                WIKIDOT.Editor.init("np-text", "np-editor-panel");
            });
            
        </script>
    
 

<div style="display:none" id="post-options-template">
	<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.showPermalink(event,'%POST_ID%')" class="btn btn-default btn-small btn-sm">Permanent Link</a>
			<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.editPost(event,'%POST_ID%')" class="btn btn-default btn-small btn-sm">Edit</a>
			<a href="javascript:;" onclick="WIKIDOT.modules.ForumViewThreadModule.listeners.deletePost(event,'%POST_ID%')" class="btn btn-danger btn-small btn-sm">Delete</a>
</div>
	
			</div>
	
	
	
</div></div>

                    </div>

                    


                    



                    

                    <div id="page-info-break"></div>
                    
                        <div id="page-options-container">
                            
                        </div>
                    
                    <div id="action-area" style="display: none;"></div>
                </div>
            </div>
            
            
            
            <div id="footer" style="display: block; visibility: visible;">
                <div class="options" style="display: block; visibility: visible;">
    <a href="http://www.wikidot.com/doc" id="wikidot-help-button">Help</a>
    &nbsp;|
    <a href="http://www.wikidot.com/legal:terms-of-service" id="wikidot-tos-button">Terms of Service</a>
    &nbsp;|
    <a href="http://www.wikidot.com/legal:privacy-policy" id="wikidot-privacy-button">Privacy</a>
    &nbsp;|
    <a href="javascript:;" id="bug-report-button" onclick="WIKIDOT.page.listeners.pageBugReport(event)">Report a bug</a>
    &nbsp;|
    <a href="javascript:;" id="abuse-report-button" onclick="WIKIDOT.page.listeners.flagPageObjectionable(event)">Flag as objectionable</a>
</div>
Powered by <a href="http://www.wikidot.com">Wikidot.com</a> 
            </div>
            
                <div id="license-area" class="license-area">
                    Unless otherwise stated, the content of this page is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 License</a>
                </div>
            
            
            



            <div id="extrac-div-1"><span></span></div><div id="extrac-div-2"><span></span></div><div id="extrac-div-3"><span></span></div>
            
            
            
            
                
            
        </div>
        
    </div>
<!-- These extra divs/spans may be used as catch-alls to add extra imagery. -->
<div id="extra-div-1"><span></span></div><div id="extra-div-2"><span></span></div><div id="extra-div-3"><span></span></div>
<div id="extra-div-4"><span></span></div><div id="extra-div-5"><span></span></div><div id="extra-div-6"><span></span></div>
</div>




</div>
<div id="dummy-ondomready-block" style="display: none;" ></div>
    <!-- Google Analytics load -->
    <script type="text/javascript">
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <!-- Quantcast -->
    <script type="text/javascript">
    _qoptions={
        qacct:"p-edL3gsnUjJzw-"
    };
    (function() {
        var qc = document.createElement('script'); qc.type = 'text/javascript'; qc.async = true;
        qc.src = ('https:' == document.location.protocol ? 'https://secure' : 'http://edge') + '.quantserve.com/quant.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(qc, s);
    })();
    </script>
    <noscript>
        <img src="http://pixel.quantserve.com/pixel/p-edL3gsnUjJzw-.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/>
    </noscript>




<div id="page-options-bottom-tips" style="display: none;">
    <div id="edit-button-hovertip">
        Click here to edit contents of this page.    </div>
</div>
<div id="page-options-bottom-2-tips"  style="display: none;">
    <div id="edit-sections-button-hovertip">
        Click here to toggle editing of individual sections of the page (if possible).         Watch headings for an &quot;edit&quot; link when available.    </div>
    <div id="edit-append-button-hovertip">
        Append content without editing the whole page source.    </div>
    <div id="history-button-hovertip">
        Check out how this page has evolved in the past.    </div>
    <div id="discuss-button-hovertip">
        If you want to discuss contents of this page - this is the easiest way to do it.    </div>
    <div id="files-button-hovertip">
        View and manage file attachments for this page.    </div>
    <div id="site-tools-button-hovertip">
        A few useful tools to manage this Site.    </div>
    <div id="backlinks-button-hovertip">
        See pages that link to and include this page.    </div>
    <div id="rename-move-button-hovertip">
        Change the name (also URL address, possibly the category) of the page.    </div>
    <div id="view-source-button-hovertip">
        View wiki source for this page without editing.    </div>
    <div id="parent-page-button-hovertip">  
        View/set parent page (used for creating breadcrumbs and structured layout).    </div>
            <div id="abuse-report-button-hovertip">
            Notify administrators if there is objectionable content in this page.        </div>
        <div id="bug-report-button-hovertip">
            Something does not work as expected? Find out what you can do.        </div>
        <div id="wikidot-help-button-hovertip">
            General Wikidot.com documentation and help section.        </div>
        <div id="wikidot-tos-button-hovertip">
            Wikidot.com Terms of Service - what you can, what you should not etc.        </div>
        <div id="wikidot-privacy-button-hovertip">
            Wikidot.com Privacy Policy.          
        </div>
    </div>
</body>
</html>